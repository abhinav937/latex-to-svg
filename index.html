<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-F2SG9BQRKK"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-F2SG9BQRKK');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LaTeX Image Generator</title>
    <meta name="description" content="A web-based LaTeX to SVG generator, an easy alternative to TexText for creating mathematical equations.">
    <meta name="keywords" content="LaTeX, SVG, TexText, Inkscape, math equations, image generator">
    <meta name="author" content="Abhinav Chinnusamy">
    <meta name="robots" content="index, follow, max-image-preview:large">

    <!-- Favicon and Icons -->
    <link rel="shortcut icon" href="./assets/icons/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" sizes="180x180" href="./assets/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="./assets/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./assets/icons/favicon-16x16.png">
    <link rel="manifest" href="./site.webmanifest">

    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="LaTeX Image Generator">
    <meta property="og:description" content="Generate high-quality SVG images from LaTeX code, no installation required. A web-based alternative to TexText for Inkscape.">
    <meta property="og:image" content="https://latex.cabhinav.com/assets/icons/share_preview.png">
    <meta property="og:image:alt" content="LaTeX Image Generator Preview">
    <meta property="og:url" content="https://latex.cabhinav.com">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="LaTeX Image Generator">

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="LaTeX Image Generator">
    <meta name="twitter:description" content="Generate high-quality SVG images from LaTeX code, no installation required. A web-based alternative to TexText for Inkscape.">
    <meta name="twitter:image" content="https://latex.cabhinav.com/assets/icons/share_preview.png">
    <meta name="twitter:creator" content="@abhinav_937">
    <meta name="twitter:site" content="@abhinav_937">

    <!-- Structured Data (Schema.org) -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "LaTeX Image Generator",
      "url": "https://latex.cabhinav.com",
      "description": "A web-based tool to generate SVG images from LaTeX code, serving as an alternative to TexText for Inkscape.",
      "creator": {
        "@type": "Person",
        "name": "Abhinav Chinnusamy",
        "url": "https://cabhinav.com"
      },
      "applicationCategory": "Utility",
      "operatingSystem": "Web"
    }
    </script>

    <!-- TSLib polyfill to prevent module resolution errors -->
    <script>
      // Polyfill for tslib to prevent module resolution errors
      if (typeof window !== 'undefined' && !window.__tslib) {
        // Add module resolution polyfill
        if (typeof window !== 'undefined') {
          window.tslib = window.__tslib;
        }
        window.__tslib = {
          __assign: Object.assign,
          __rest: function (source, exclude) {
            var target = {};
            for (var prop in source) if (Object.prototype.hasOwnProperty.call(source, prop) && exclude.indexOf(prop) < 0) target[prop] = source[prop];
            return target;
          },
          __decorate: function (decorators, target, key, desc) {
            var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
            if (typeof Reflect !== "undefined" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
            else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
            return c > 3 && r && Object.defineProperty(target, key, r), r;
          },
          __metadata: function (metadataKey, metadataValue) {
            if (typeof Reflect !== "undefined" && typeof Reflect.metadata === "function") return Reflect.metadata(metadataKey, metadataValue);
          },
          __awaiter: function (thisArg, _arguments, P, generator) {
            function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
            return new (P || (P = Promise))(function (resolve, reject) {
              function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
              function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
              function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
              step((generator = generator.apply(thisArg, _arguments || [])).next());
            });
          },
          __generator: function (thisArg, body) {
            var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
            return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
            function verb(n) { return function (v) { return step([n, v]); }; }
            function step(op) {
              if (f) throw new TypeError("Generator is already executing.");
              while (_) try {
                if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
                if (y = 0, t) op = [op[0] & 2, t.value];
                switch (op[0]) {
                  case 0: case 1: t = op; break;
                  case 4: _.label++; return { value: op[1], done: false };
                  case 5: _.label++; y = op[1]; op = [0]; continue;
                  case 7: op = _.ops.pop(); _.trys.pop(); continue;
                  default:
                    if (!((t = (t = _.trys).length > 0 && t[t.length - 1]) || (op[0] === 6 && _.label < t[0]))) { _.label = t[0]; break; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
                }
                op = body.call(thisArg, _);
              } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
              if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
            }
          },
          __exportStar: function (m, exports) {
            for (var p in m) if (p !== "default" && !exports.hasOwnProperty(p)) exports[p] = m[p];
          },
          __createBinding: function (o, m, k, k2) {
            if (k2 === undefined) k2 = k;
            o[k2] = m[k];
          },
          __values: function (o) {
            var s = typeof Symbol === "function" && Symbol.iterator && o[Symbol.iterator] || o["@@iterator"];
            if (s) return s.call(o);
            if (Array.isArray(o)) return function* () {
              yield* o;
            }();
            throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
          },
          __read: function (o, n) {
            var m = typeof Symbol === "function" && o[Symbol.iterator] || o["@@iterator"];
            if (!m) return o;
            var i = m.call(o), r, ar = [], e;
            try {
              while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
            }
            catch (error) { e = { error: error }; }
            finally {
              try {
                if (r && !r.done && (m = i["return"])) m.call(i);
              }
              finally { if (e) throw e.error; }
            }
            return ar;
          },
          __spread: function () {
            for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
            return ar;
          },
          __spreadArrays: function () {
            for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));
            return ar;
          },
          __await: function (v) {
            return this instanceof __await ? (this.v = v, this) : new __await(v);
          },
          __asyncGenerator: function (thisArg, _arguments, generator) {
            if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
            var g = generator.apply(thisArg, _arguments || []), i, q = [];
            return i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i;
            function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }
            function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }
            function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }
            function fulfill(value) { resume("next", value); }
            function reject(value) { resume("throw", value); }
            function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }
            step((i.next = function () { return step(g["next"]); })());
          },
          __asyncDelegator: function (o) {
            var i, p;
            return i = {}, verb("next"), verb("throw", function (e) { throw e; }), verb("return"), i[Symbol.iterator] = function () { return this; }, i;
            function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: o[n](v), done: n === "return" } : f ? f(v) : v; } : f; }
          },
          __asyncValues: function (o) {
            if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
            var m = o[Symbol.asyncIterator], i;
            return m ? m.call(o) : (o = typeof __values === "function" ? __values(o) : o[Symbol.iterator](), i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i);
            function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }
            function settle(resolve, reject, d, v) { Promise.resolve(v).then(function (v) { resolve({ value: v, done: d }); }, reject); }
          },
          __makeTemplateObject: function (cooked, raw) {
            if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }
            return cooked;
          },
          __importStar: function (mod) {
            if (mod && mod.__esModule) return mod;
            var result = {};
            if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];
            result["default"] = mod;
            return result;
          },
          __importDefault: function (mod) {
            return (mod && mod.__esModule) ? mod : { "default": mod };
          },
          __classPrivateFieldGet: function (receiver, privateMap) {
            if (!privateMap.has(receiver)) {
              throw new TypeError("attempted to get private field on non-instance");
            }
            return privateMap.get(receiver);
          },
          __classPrivateFieldSet: function (receiver, privateMap, value) {
            if (!privateMap.has(receiver)) {
              throw new TypeError("attempted to set private field on non-instance");
            }
            privateMap.set(receiver, value);
            return value;
          },
          __classPrivateFieldIn: function (s, a) {
            if (a.has(s)) throw TypeError("#<private> is not accessible");
            return a;
          }
        };
        
        // Add module resolution polyfill for tslib
        if (typeof window !== 'undefined') {
          window.tslib = window.__tslib;
        }
      }
    </script>
    
    <!-- Material Web Components JS - Using bundled version -->
    <script type="module">
      // Module resolution polyfill for tslib
      if (typeof window !== 'undefined') {
        // Override import map to handle tslib
        if (!window.importMapPolyfill) {
          window.importMapPolyfill = true;
          const originalImport = window.import;
          if (originalImport) {
            window.import = function(specifier, options) {
              if (specifier === 'tslib') {
                return Promise.resolve(window.__tslib || window.tslib);
              }
              return originalImport.call(this, specifier, options);
            };
          }
        }
      }
      
      // Check if Material Web Components are already loaded from bundle
      // Wait a bit longer for the bundle to load
      setTimeout(() => {
        if (!customElements.get('md-outlined-text-field')) {
          // Load from CDN as fallback
          const loadMaterialWeb = () => {
            const script = document.createElement('script');
            script.type = 'module';
            script.src = 'https://cdn.jsdelivr.net/npm/@material/web@2.0.0/all.js';
            script.crossOrigin = 'anonymous';
            script.onerror = () => {
              console.error('Material Web Components failed to load from CDN');
              const errorMessage = document.getElementById('error-message');
              if (errorMessage) {
                errorMessage.innerHTML = `<strong>Loading Error:</strong> Material Web Components failed to load. Please check your internet connection and refresh the page.`;
                errorMessage.style.display = 'block';
              }
            };
            document.head.appendChild(script);
          };
          
          loadMaterialWeb();
        }
      }, 1000);
    </script>
    <!-- Roboto Font -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap">
    <!-- Material Icons -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <!-- Material Symbols -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <!-- Styles -->
    <link rel="stylesheet" href="./style.css">
    <!-- Preload critical resources for autocomplete -->
    <link rel="preload" href="./latex-commands.json" as="fetch" crossorigin="anonymous">
    <link rel="preload" href="./bundle.js" as="script" crossorigin="anonymous">
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap" as="style">
    <link rel="preload" href="https://fonts.googleapis.com/icon?family=Material+Icons" as="style">
    <!-- Script -->
    <script defer src="./script.js"></script>
    <!-- Material Web Components Bundle -->
    <script type="module" src="./bundle.js"></script>
</head>
<body>
  <header>
    <div class="logo">LaTeX Image Generator</div>
    <nav>
      <a href="./help/">Help</a>
    </nav>
  </header>

  <div class="container">
    <div class="content-wrapper">
      <!-- Main Content -->
      <div class="main-content">
        <div class="button-group">
          <md-assist-chip
            class="filter-chip-style"
            id="example1"
            label="div E = ρ / ε₀"
            onclick="setExample('$\\nabla \\cdot \\mathbf{E} = \\frac{\\rho}{\\varepsilon_0}$')"
            data-tooltip="Maxwell Equation example"
          ></md-assist-chip>
          <md-assist-chip
            class="filter-chip-style"
            id="example2"
            label="Subscript (V_gs)"
            onclick="setExample('$V_{gs}$')"
            data-tooltip="Subscript example"
          ></md-assist-chip>
          <md-assist-chip
            class="filter-chip-style"
            id="example3"
            label="Fraction (di/dt)"
            onclick="setExample('$\\frac{di}{dt}$')"
            data-tooltip="Fraction example"
          ></md-assist-chip>
          <md-assist-chip
            class="filter-chip-style"
            id="example4"
            label="Sum"
            onclick="setExample('$\\sum_{n=1}^{\\infty} \\frac{1}{n^2}$')"
            data-tooltip="Sum example"
          ></md-assist-chip>
        </div>

        <div class="latex-input-container">
          <md-outlined-text-field
            id="latex-input"
            type="textarea"
            rows="3"
            label="LaTeX Command"
            placeholder="Enter LaTeX code (e.g., $E = mc^2$ or R_{DS}) - Autocomplete loading..."
            aria-label="LaTeX input"
          ></md-outlined-text-field>
          <md-icon-button 
            id="ai-fix-button" 
            onclick="fixLatexWithAI()" 
            data-tooltip="Fix LaTeX syntax errors with AI"
            style="position: absolute; right: 8px; top: 50%; transform: translateY(-50%); z-index: 10;"
          >
            <md-icon>auto_fix_high</md-icon>
          </md-icon-button>
        </div>

        <div id="error-message"></div>

        <div class="action-buttons">
          <div style="position: relative; display: inline-block;">
            <md-filled-button onclick="renderLaTeX()" id="render-button">Render</md-filled-button>
            <md-circular-progress id="render-spinner" indeterminate style="position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%) scale(0.75); display: none;"></md-circular-progress>
          </div>
          <md-assist-chip onclick="clearInput()" id="clear-button">
            <md-icon slot="icon">clear</md-icon>
            Clear
          </md-assist-chip>
          <div class="scale-control">
            <label for="scale-input" class="scale-label">Point Size:</label>
            <input type="number" id="scale-input" min="8" max="72" value="12" step="1" class="scale-input">
            <span class="scale-unit">pt</span>
          </div>
        </div>

        <div id="latex-preview">
          <img id="latex-image" src="" alt="LaTeX Rendered Image" style="display: none;">
          <div id="image-actions" style="display: none;">
            <md-icon-button onclick="copyImage()" id="copy-button" data-tooltip="Copy SVG to clipboard">
              <md-icon>content_copy</md-icon>
            </md-icon-button>
            <md-icon-button onclick="downloadSVG()" id="download-button" data-tooltip="Download SVG file">
              <md-icon>download</md-icon>
            </md-icon-button>
            <md-icon-button onclick="copySVGCode()" id="copy-svgcode-button" data-tooltip="Copy SVG code" style="display:none;">
              <md-icon>code</md-icon>
            </md-icon-button>
          </div>
        </div>

        <!-- Move instructions to the bottom -->
        <div class="instructions">
          <p><strong>How to use:</strong></p>
          <ul>
            <li>Enter LaTeX commands (e.g., <code>$E = mc^2$</code> or <code>R\textsubscript{ds,on}</code>)</li>
            <li>Use <code>$...$</code> or <code>$$...$$</code> for math mode (italicized equations) or plain text for upright text</li>
            <li><strong>Autocomplete:</strong> Type <code>\</code> followed by any letter to see LaTeX command suggestions with arguments</li>
            <li><strong>AI Fix:</strong> Click the AI button to automatically fix LaTeX syntax errors</li>
          </ul>
        </div>
      </div>

      <!-- Sidebar for History -->
      <aside class="sidebar">
        <div class="hero">
          <h1>Create LaTeX Equations Instantly</h1>
          <p>Generate high-quality SVG images from LaTeX code, no installation required. A web-based alternative to TexText for Inkscape.</p>
        </div>
        <div id="history-section">
          <!-- Enhanced history system will be populated by JavaScript -->
        </div>
      </aside>
    </div>
  </div>

  <footer>
    <div class="footer-content">
      <div class="footer-section">
      </div>
    </div>
    <div class="back-to-top">
      <md-text-button onclick="window.scrollTo({top: 0, behavior: 'smooth'})">
        Back to Top
      </md-text-button>
      <p>© 2025 <a href="https://cabhinav.com">Abhinav Chinnusamy</a></p>
    </div>
  </footer>
</body>
</html>